import{c as ae,an as te,aR as ne,aS as ie,j as e,ao as Y,aT as ce,aU as re,aV as de,ap as V,x as S,aP as le,H as oe,C as k,z as w,a2 as me,A as P,E as T,y as E,au as _,T as q,G as I,K as t,I as x,S as F,r as A,s as R,v as U,w as f,L as H,a8 as he}from"./index-BtknkMaH.js";import{r as d}from"./vendor-Dl_IvdXv.js";import{T as xe,a as ue,b as K,c as L}from"./tabs-_ak9GdYN.js";import{S as z}from"./save-C_i1zYqs.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=ae("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);var O="Switch",[pe,ke]=te(O),[je,ve]=pe(O),Z=d.forwardRef((n,p)=>{const{__scopeSwitch:c,name:j,checked:v,defaultChecked:b,required:l,disabled:m,value:i="on",onCheckedChange:u,form:h,...o}=n,[g,D]=d.useState(null),B=ne(p,y=>D(y)),N=d.useRef(!1),M=g?h||!!g.closest("form"):!0,[C=!1,G]=ie({prop:v,defaultProp:b,onChange:u});return e.jsxs(je,{scope:c,checked:C,disabled:m,children:[e.jsx(Y.button,{type:"button",role:"switch","aria-checked":C,"aria-required":l,"data-state":J(C),"data-disabled":m?"":void 0,disabled:m,value:i,...o,ref:B,onClick:ce(n.onClick,y=>{G(s=>!s),M&&(N.current=y.isPropagationStopped(),N.current||y.stopPropagation())})}),M&&e.jsx(ge,{control:g,bubbles:!N.current,name:j,value:i,checked:C,required:l,disabled:m,form:h,style:{transform:"translateX(-100%)"}})]})});Z.displayName=O;var W="SwitchThumb",X=d.forwardRef((n,p)=>{const{__scopeSwitch:c,...j}=n,v=ve(W,c);return e.jsx(Y.span,{"data-state":J(v.checked),"data-disabled":v.disabled?"":void 0,...j,ref:p})});X.displayName=W;var ge=n=>{const{control:p,checked:c,bubbles:j=!0,...v}=n,b=d.useRef(null),l=re(c),m=de(p);return d.useEffect(()=>{const i=b.current,u=window.HTMLInputElement.prototype,o=Object.getOwnPropertyDescriptor(u,"checked").set;if(l!==c&&o){const g=new Event("click",{bubbles:j});o.call(i,c),i.dispatchEvent(g)}},[l,c,j]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:c,...v,tabIndex:-1,ref:b,style:{...n.style,...m,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function J(n){return n?"checked":"unchecked"}var Q=Z,ye=X;const r=d.forwardRef(({className:n,...p},c)=>e.jsx(Q,{className:V("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",n),...p,ref:c,children:e.jsx(ye,{className:V("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));r.displayName=Q.displayName;function we(){const[n,p]=d.useState(!1),[c,j]=d.useState(!1),[v,b]=d.useState(!1),[l,m]=d.useState({apiKey:"",apiSecret:"",senderId:"PROPERTY",environment:"sandbox",enabled:!0}),[i,u]=d.useState({consumerKey:"",consumerSecret:"",passkey:"",shortcode:"174379",environment:"sandbox",enabled:!0,callbackUrl:"https://your-app.replit.app/api/mpesa/callback"}),[h,o]=d.useState({companyName:"Property Management System",companyEmail:"admin@propertymanager.com",companyPhone:"+254700123456",timezone:"Africa/Nairobi",currency:"KES",autoInvoiceGeneration:!0,paymentReminders:!0,latePaymentFees:!0}),[g,D]=d.useState(""),B=typeof Intl<"u"&&typeof Intl.supportedValuesOf=="function"?Intl.supportedValuesOf("timeZone"):["Africa/Nairobi","UTC","America/New_York"],N=s=>{try{return(new Intl.DateTimeFormat("en-US",{timeZone:s,timeZoneName:"short"}).formatToParts(new Date).find(se=>se.type==="timeZoneName")?.value||"").replace("GMT","GMT").replace("UTC","UTC")}catch{return"UTC"}},M=B.filter(s=>{if(!g.trim())return!0;const a=g.toLowerCase();return`${s} (${N(s)})`.toLowerCase().includes(a)}),C=async()=>{j(!0),setTimeout(()=>{j(!1),alert("SMS test successful! Test message sent.")},2e3)},G=async()=>{b(!0),setTimeout(()=>{b(!1),alert("M-Pesa connection test successful!")},2e3)},y=s=>{console.log(`Saving ${s} settings`),alert(`${s} settings saved successfully!`)};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold","data-testid":"settings-title",children:"Settings"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure system settings and API integrations"})]}),e.jsxs(S,{variant:"outline",onClick:()=>p(!n),"data-testid":"button-toggle-api-keys",children:[n?e.jsx(le,{className:"h-4 w-4 mr-2"}):e.jsx(oe,{className:"h-4 w-4 mr-2"}),n?"Hide":"Show"," API Keys"]})]}),e.jsxs(xe,{defaultValue:"sms",className:"space-y-6",children:[e.jsxs(ue,{className:"grid w-full grid-cols-4",children:[e.jsx(K,{value:"sms","data-testid":"tab-sms",children:"SMS Integration"}),e.jsx(K,{value:"mpesa","data-testid":"tab-mpesa",children:"M-Pesa Integration"}),e.jsx(K,{value:"system","data-testid":"tab-system",children:"System Settings"}),e.jsx(K,{value:"notifications","data-testid":"tab-notifications",children:"Notifications"})]}),e.jsxs(L,{value:"sms",className:"space-y-6",children:[e.jsxs(k,{children:[e.jsx(w,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-5 w-5"}),e.jsxs("div",{children:[e.jsx(P,{children:"Advanta SMS Integration"}),e.jsx(T,{children:"Configure SMS notifications using Advanta SMS API"})]}),e.jsx("div",{className:"ml-auto",children:l.enabled?e.jsxs(E,{variant:"default",className:"bg-green-100 text-green-800",children:[e.jsx(_,{className:"h-3 w-3 mr-1"}),"Active"]}):e.jsxs(E,{variant:"destructive",children:[e.jsx(q,{className:"h-3 w-3 mr-1"}),"Inactive"]})})]})}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"sms-api-key",children:"API Key"}),e.jsx(x,{id:"sms-api-key",type:n?"text":"password",value:n?l.apiKey:"••••••••••••••••••••••••••••••••",onChange:s=>m(a=>({...a,apiKey:s.target.value})),"data-testid":"input-sms-api-key"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"sms-api-secret",children:"API Secret"}),e.jsx(x,{id:"sms-api-secret",type:n?"text":"password",value:n?l.apiSecret:"••••••••••••••••••••••••••••••••",onChange:s=>m(a=>({...a,apiSecret:s.target.value})),"data-testid":"input-sms-api-secret"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"sms-sender-id",children:"Sender ID"}),e.jsx(x,{id:"sms-sender-id",value:l.senderId,onChange:s=>m(a=>({...a,senderId:s.target.value})),placeholder:"PROPERTY","data-testid":"input-sms-sender-id"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"sms-environment",children:"Environment"}),e.jsxs(F,{value:l.environment,onValueChange:s=>m(a=>({...a,environment:s})),children:[e.jsx(A,{"data-testid":"select-sms-environment",children:e.jsx(R,{})}),e.jsxs(U,{children:[e.jsx(f,{value:"sandbox",children:"Sandbox"}),e.jsx(f,{value:"production",children:"Production"})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(r,{id:"sms-enabled",checked:l.enabled,onCheckedChange:s=>m(a=>({...a,enabled:s})),"data-testid":"switch-sms-enabled"}),e.jsx(t,{htmlFor:"sms-enabled",children:"Enable SMS notifications"})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsxs(S,{onClick:C,disabled:c||!l.enabled,"data-testid":"button-test-sms",children:[c?e.jsx(H,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx($,{className:"h-4 w-4 mr-2"}),"Test SMS"]}),e.jsxs(S,{onClick:()=>y("SMS"),"data-testid":"button-save-sms",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Save SMS Settings"]})]})]})]}),e.jsxs(k,{children:[e.jsxs(w,{children:[e.jsx(P,{children:"Advanta SMS API Documentation"}),e.jsx(T,{children:"Integration guidelines and endpoints"})]}),e.jsx(I,{className:"space-y-3",children:e.jsxs("div",{className:"text-sm space-y-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Base URL:"})," ",e.jsx("code",{className:"bg-muted px-2 py-1 rounded",children:"https://api.advantasms.com"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Send SMS Endpoint:"})," ",e.jsx("code",{className:"bg-muted px-2 py-1 rounded",children:"POST /v1/sms/send"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Balance Check:"})," ",e.jsx("code",{className:"bg-muted px-2 py-1 rounded",children:"GET /v1/account/balance"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Required Headers:"}),e.jsxs("ul",{className:"list-disc list-inside ml-4 mt-1",children:[e.jsxs("li",{children:["Authorization: Bearer ","{API_KEY}"]}),e.jsx("li",{children:"Content-Type: application/json"})]})]})]})})]})]}),e.jsxs(L,{value:"mpesa",className:"space-y-6",children:[e.jsxs(k,{children:[e.jsx(w,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"h-5 w-5"}),e.jsxs("div",{children:[e.jsx(P,{children:"M-Pesa Integration"}),e.jsx(T,{children:"Configure M-Pesa payments using Safaricom Daraja API"})]}),e.jsx("div",{className:"ml-auto",children:i.enabled?e.jsxs(E,{variant:"default",className:"bg-green-100 text-green-800",children:[e.jsx(_,{className:"h-3 w-3 mr-1"}),"Active"]}):e.jsxs(E,{variant:"destructive",children:[e.jsx(q,{className:"h-3 w-3 mr-1"}),"Inactive"]})})]})}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"mpesa-consumer-key",children:"Consumer Key"}),e.jsx(x,{id:"mpesa-consumer-key",type:n?"text":"password",value:n?i.consumerKey:"••••••••••••••••••••••••••••••••",onChange:s=>u(a=>({...a,consumerKey:s.target.value})),"data-testid":"input-mpesa-consumer-key"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"mpesa-consumer-secret",children:"Consumer Secret"}),e.jsx(x,{id:"mpesa-consumer-secret",type:n?"text":"password",value:n?i.consumerSecret:"••••••••••••••••••••••••••••••••",onChange:s=>u(a=>({...a,consumerSecret:s.target.value})),"data-testid":"input-mpesa-consumer-secret"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"mpesa-passkey",children:"Passkey"}),e.jsx(x,{id:"mpesa-passkey",type:n?"text":"password",value:n?i.passkey:"••••••••••••••••••••••••••••••••",onChange:s=>u(a=>({...a,passkey:s.target.value})),"data-testid":"input-mpesa-passkey"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"mpesa-shortcode",children:"Business Shortcode"}),e.jsx(x,{id:"mpesa-shortcode",value:i.shortcode,onChange:s=>u(a=>({...a,shortcode:s.target.value})),"data-testid":"input-mpesa-shortcode"})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"mpesa-callback",children:"Callback URL"}),e.jsx(x,{id:"mpesa-callback",value:i.callbackUrl,onChange:s=>u(a=>({...a,callbackUrl:s.target.value})),"data-testid":"input-mpesa-callback"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"mpesa-environment",children:"Environment"}),e.jsxs(F,{value:i.environment,onValueChange:s=>u(a=>({...a,environment:s})),children:[e.jsx(A,{"data-testid":"select-mpesa-environment",children:e.jsx(R,{})}),e.jsxs(U,{children:[e.jsx(f,{value:"sandbox",children:"Sandbox"}),e.jsx(f,{value:"production",children:"Production"})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-6",children:[e.jsx(r,{id:"mpesa-enabled",checked:i.enabled,onCheckedChange:s=>u(a=>({...a,enabled:s})),"data-testid":"switch-mpesa-enabled"}),e.jsx(t,{htmlFor:"mpesa-enabled",children:"Enable M-Pesa payments"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsxs(S,{onClick:G,disabled:v||!i.enabled,"data-testid":"button-test-mpesa",children:[v?e.jsx(H,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx($,{className:"h-4 w-4 mr-2"}),"Test Connection"]}),e.jsxs(S,{onClick:()=>y("M-Pesa"),"data-testid":"button-save-mpesa",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Save M-Pesa Settings"]})]})]})]}),e.jsxs(k,{children:[e.jsxs(w,{children:[e.jsx(P,{children:"Safaricom Daraja API Documentation"}),e.jsx(T,{children:"M-Pesa integration endpoints and requirements"})]}),e.jsx(I,{className:"space-y-3",children:e.jsxs("div",{className:"text-sm space-y-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Sandbox URL:"})," ",e.jsx("code",{className:"bg-muted px-2 py-1 rounded",children:"https://sandbox.safaricom.co.ke"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Production URL:"})," ",e.jsx("code",{className:"bg-muted px-2 py-1 rounded",children:"https://api.safaricom.co.ke"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"STK Push:"})," ",e.jsx("code",{className:"bg-muted px-2 py-1 rounded",children:"POST /mpesa/stkpush/v1/processrequest"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Account Balance:"})," ",e.jsx("code",{className:"bg-muted px-2 py-1 rounded",children:"POST /mpesa/accountbalance/v1/query"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Authentication:"})," ",e.jsx("code",{className:"bg-muted px-2 py-1 rounded",children:"GET /oauth/v1/generate?grant_type=client_credentials"})]})]})})]})]}),e.jsx(L,{value:"system",className:"space-y-6",children:e.jsxs(k,{children:[e.jsxs(w,{children:[e.jsx(P,{children:"General System Settings"}),e.jsx(T,{children:"Configure basic system preferences"})]}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"company-name",children:"Company Name"}),e.jsx(x,{id:"company-name",value:h.companyName,onChange:s=>o(a=>({...a,companyName:s.target.value})),"data-testid":"input-company-name"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"company-email",children:"Company Email"}),e.jsx(x,{id:"company-email",type:"email",value:h.companyEmail,onChange:s=>o(a=>({...a,companyEmail:s.target.value})),"data-testid":"input-company-email"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"company-phone",children:"Company Phone"}),e.jsx(x,{id:"company-phone",value:h.companyPhone,onChange:s=>o(a=>({...a,companyPhone:s.target.value})),"data-testid":"input-company-phone"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"timezone",children:"Timezone"}),e.jsxs(F,{value:h.timezone,onValueChange:s=>o(a=>({...a,timezone:s})),children:[e.jsx(A,{"data-testid":"select-timezone",children:e.jsx(R,{})}),e.jsxs(U,{children:[e.jsx("div",{className:"p-2",children:e.jsx(x,{value:g,onChange:s=>D(s.target.value),placeholder:"Search timezone or GMT"})}),M.map(s=>e.jsxs(f,{value:s,children:[s," (",N(s),")"]},s))]})]})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"currency",children:"Default Currency"}),e.jsxs(F,{value:h.currency,onValueChange:s=>o(a=>({...a,currency:s})),children:[e.jsx(A,{"data-testid":"select-currency",children:e.jsx(R,{})}),e.jsxs(U,{children:[e.jsx(f,{value:"KES",children:"KES - Kenyan Shilling"}),e.jsx(f,{value:"USD",children:"USD - US Dollar"}),e.jsx(f,{value:"EUR",children:"EUR - Euro"})]})]})]}),e.jsxs("div",{className:"space-y-3 pt-4 border-t",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(r,{id:"auto-invoice",checked:h.autoInvoiceGeneration,onCheckedChange:s=>o(a=>({...a,autoInvoiceGeneration:s})),"data-testid":"switch-auto-invoice"}),e.jsx(t,{htmlFor:"auto-invoice",children:"Automatic invoice generation"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(r,{id:"payment-reminders",checked:h.paymentReminders,onCheckedChange:s=>o(a=>({...a,paymentReminders:s})),"data-testid":"switch-payment-reminders"}),e.jsx(t,{htmlFor:"payment-reminders",children:"Send payment reminders"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(r,{id:"late-fees",checked:h.latePaymentFees,onCheckedChange:s=>o(a=>({...a,latePaymentFees:s})),"data-testid":"switch-late-fees"}),e.jsx(t,{htmlFor:"late-fees",children:"Apply late payment fees"})]})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsxs(S,{onClick:()=>y("System"),"data-testid":"button-save-system",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Save System Settings"]})})]})]})}),e.jsx(L,{value:"notifications",className:"space-y-6",children:e.jsxs(k,{children:[e.jsxs(w,{children:[e.jsx(P,{children:"Notification Preferences"}),e.jsx(T,{children:"Configure when and how notifications are sent"})]}),e.jsxs(I,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(t,{className:"text-base font-medium",children:"Payment Reminders"}),e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(t,{htmlFor:"reminder-1",children:"Send 3 days before due date"}),e.jsx(r,{id:"reminder-1",defaultChecked:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(t,{htmlFor:"reminder-2",children:"Send on due date"}),e.jsx(r,{id:"reminder-2",defaultChecked:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(t,{htmlFor:"reminder-3",children:"Send 3 days after due date"}),e.jsx(r,{id:"reminder-3",defaultChecked:!0})]})]})]}),e.jsxs("div",{children:[e.jsx(t,{className:"text-base font-medium",children:"Invoice Notifications"}),e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(t,{htmlFor:"invoice-created",children:"New invoice created"}),e.jsx(r,{id:"invoice-created",defaultChecked:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(t,{htmlFor:"invoice-paid",children:"Invoice payment received"}),e.jsx(r,{id:"invoice-paid",defaultChecked:!0})]})]})]}),e.jsxs("div",{children:[e.jsx(t,{className:"text-base font-medium",children:"System Notifications"}),e.jsxs("div",{className:"space-y-2 mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(t,{htmlFor:"new-tenant",children:"New tenant registration"}),e.jsx(r,{id:"new-tenant",defaultChecked:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(t,{htmlFor:"maintenance-request",children:"Maintenance requests"}),e.jsx(r,{id:"maintenance-request",defaultChecked:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(t,{htmlFor:"low-sms-balance",children:"Low SMS balance alert"}),e.jsx(r,{id:"low-sms-balance",defaultChecked:!0})]})]})]})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsxs(S,{onClick:()=>y("Notifications"),"data-testid":"button-save-notifications",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),"Save Notification Settings"]})})]})]})})]})]})}export{we as Settings};
