import{d as p,j as e,C as m,z as h,A as o,ak as M,G as j,a5 as X,a6 as J,B as Z,T as u,E as N,x as r,L as D,ac as S,ad as C,ae as l,af as t,ag as T,ah as a,y as i,ay as ee,H as q,aj as se,aA as ae,a8 as te,D as K,g as E,h as F,i as B,K as c,k as ne,I as ie,a4 as le,S as re,r as ce,s as de,v as xe,w as g,aC as me,au as he,a0 as v}from"./index-BtknkMaH.js";import{r as f}from"./vendor-Dl_IvdXv.js";import{T as oe,a as je,b as y,c as w}from"./tabs-_ak9GdYN.js";import{M as O}from"./map-pin-BiMmByZC.js";import{D as V}from"./download-ILkuwfnn.js";import{C as ue}from"./circle-x-Qbe_jolQ.js";function we(){const[z,H]=f.useState("maintenance"),[d,$]=f.useState(null),[G,L]=f.useState(!1),[U,b]=f.useState(!1),{data:n}=p({queryKey:["/api/auth/tenant"],queryFn:()=>v("GET","/api/auth/tenant"),enabled:!1}),x=n?.id||null,{data:k=[],isLoading:Y}=p({queryKey:[`/api/maintenance-requests/tenant/${x}`],queryFn:()=>v("GET",`/api/maintenance-requests/tenant/${x}`)}),{data:R=[],isLoading:W}=p({queryKey:[`/api/invoices/tenant/${x}`],queryFn:()=>v("GET",`/api/invoices/tenant/${x}`)}),{data:A=[],isLoading:_}=p({queryKey:[`/api/receipts/tenant/${x}`],queryFn:()=>v("GET",`/api/receipts/tenant/${x}`)}),P=s=>{switch(s){case"completed":return e.jsx(he,{className:"h-4 w-4 text-green-500"});case"in_progress":return e.jsx(me,{className:"h-4 w-4 text-blue-500"});case"pending":return e.jsx(u,{className:"h-4 w-4 text-yellow-500"});case"cancelled":return e.jsx(ue,{className:"h-4 w-4 text-red-500"});default:return e.jsx(u,{className:"h-4 w-4 text-gray-500"})}},I=s=>{switch(s){case"completed":return e.jsx(i,{variant:"default",className:"bg-green-500",children:"Completed"});case"in_progress":return e.jsx(i,{variant:"secondary",className:"bg-blue-500 text-white",children:"In Progress"});case"pending":return e.jsx(i,{variant:"outline",className:"bg-yellow-500 text-white",children:"Pending"});case"cancelled":return e.jsx(i,{variant:"destructive",children:"Cancelled"});default:return e.jsx(i,{variant:"outline",children:"Unknown"})}},Q=s=>{switch(s){case"paid":return e.jsx(i,{variant:"default",className:"bg-green-500",children:"Paid"});case"pending":return e.jsx(i,{variant:"outline",className:"bg-yellow-500 text-white",children:"Pending"});case"overdue":return e.jsx(i,{variant:"destructive",children:"Overdue"});default:return e.jsx(i,{variant:"outline",children:"Unknown"})}};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Tenant Portal"}),e.jsxs("p",{className:"text-muted-foreground",children:["Welcome back, ",n.name]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Property"}),e.jsxs("div",{className:"font-semibold",children:[n.property," - ",n.unit]})]})]}),e.jsxs(m,{children:[e.jsx(h,{children:e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5"}),"Your Information"]})}),e.jsx(j,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Name"})]}),e.jsx("p",{className:"text-sm",children:n.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Phone"})]}),e.jsx("p",{className:"text-sm",children:n.phone})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Email"})]}),e.jsx("p",{className:"text-sm",children:n.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Property"})]}),e.jsx("p",{className:"text-sm",children:n.property})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Unit"})]}),e.jsx("p",{className:"text-sm",children:n.unit})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Address"})]}),e.jsx("p",{className:"text-sm",children:n.address})]})]})})]}),e.jsxs(oe,{value:z,onValueChange:H,className:"space-y-4",children:[e.jsxs(je,{className:"grid w-full grid-cols-4",children:[e.jsx(y,{value:"maintenance",children:"Maintenance"}),e.jsx(y,{value:"statements",children:"Statements"}),e.jsx(y,{value:"invoices",children:"Invoices"}),e.jsx(y,{value:"receipts",children:"Receipts"})]}),e.jsx(w,{value:"maintenance",className:"space-y-4",children:e.jsxs(m,{children:[e.jsxs(h,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[e.jsxs("div",{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-5 w-5"}),"Maintenance Requests"]}),e.jsx(N,{children:"Report and track maintenance issues"})]}),e.jsxs(r,{onClick:()=>b(!0),children:[e.jsx(u,{className:"h-4 w-4 mr-2"}),"New Request"]})]}),e.jsx(j,{children:Y?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(D,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading requests..."})]}):e.jsxs(S,{children:[e.jsx(C,{children:e.jsxs(l,{children:[e.jsx(t,{children:"Request"}),e.jsx(t,{children:"Priority"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Date"}),e.jsx(t,{children:"Actions"})]})}),e.jsx(T,{children:Array.isArray(k)?k.map(s=>e.jsxs(l,{children:[e.jsx(a,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.title}),e.jsx("div",{className:"text-sm text-muted-foreground truncate max-w-xs",children:s.description})]})}),e.jsx(a,{children:e.jsx(i,{variant:s.priority==="urgent"?"destructive":"outline",children:s.priority})}),e.jsx(a,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[P(s.status),I(s.status)]})}),e.jsx(a,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-4 w-4 text-muted-foreground"}),new Date(s.createdAt).toLocaleDateString()]})}),e.jsx(a,{children:e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>{$(s),L(!0)},children:[e.jsx(q,{className:"h-3 w-3 mr-1"}),"View"]})})]},s.id)):e.jsx(l,{children:e.jsx(a,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No maintenance requests found"})})})]})})]})}),e.jsx(w,{value:"statements",className:"space-y-4",children:e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-5 w-5"}),"Account Statements"]}),e.jsx(N,{children:"Your account balance and transaction history"})]}),e.jsx(j,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-950/20 rounded-lg",children:[e.jsx("div",{className:"text-sm text-green-600 dark:text-green-400",children:"Current Balance"}),e.jsx("div",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:"KSh 0"})]}),e.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[e.jsx("div",{className:"text-sm text-blue-600 dark:text-blue-400",children:"This Month"}),e.jsx("div",{className:"text-2xl font-bold text-blue-700 dark:text-blue-300",children:"KSh 15,000"})]}),e.jsxs("div",{className:"p-4 bg-purple-50 dark:bg-purple-950/20 rounded-lg",children:[e.jsx("div",{className:"text-sm text-purple-600 dark:text-purple-400",children:"Last Payment"}),e.jsx("div",{className:"text-2xl font-bold text-purple-700 dark:text-purple-300",children:"KSh 15,000"})]})]}),e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Detailed statements will be available here"})]})})]})}),e.jsx(w,{value:"invoices",className:"space-y-4",children:e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-5 w-5"}),"Invoices"]}),e.jsx(N,{children:"Your rent and utility invoices"})]}),e.jsx(j,{children:W?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(D,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading invoices..."})]}):e.jsxs(S,{children:[e.jsx(C,{children:e.jsxs(l,{children:[e.jsx(t,{children:"Invoice #"}),e.jsx(t,{children:"Description"}),e.jsx(t,{children:"Amount"}),e.jsx(t,{children:"Due Date"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Actions"})]})}),e.jsx(T,{children:Array.isArray(R)?R.map(s=>e.jsxs(l,{children:[e.jsx(a,{className:"font-mono text-sm",children:s.invoiceNumber}),e.jsx(a,{children:s.description}),e.jsxs(a,{className:"font-mono",children:["KSh ",parseFloat(s.amount).toLocaleString()]}),e.jsx(a,{children:new Date(s.dueDate).toLocaleDateString()}),e.jsx(a,{children:Q(s.status)}),e.jsx(a,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{variant:"outline",size:"sm",children:[e.jsx(q,{className:"h-3 w-3 mr-1"}),"View"]}),e.jsxs(r,{variant:"outline",size:"sm",children:[e.jsx(V,{className:"h-3 w-3 mr-1"}),"Download"]})]})})]},s.id)):e.jsx(l,{children:e.jsx(a,{colSpan:6,className:"text-center py-8 text-muted-foreground",children:"No invoices found"})})})]})})]})}),e.jsx(w,{value:"receipts",className:"space-y-4",children:e.jsxs(m,{children:[e.jsxs(h,{children:[e.jsxs(o,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5"}),"Payment Receipts"]}),e.jsx(N,{children:"Your payment confirmations and receipts"})]}),e.jsx(j,{children:_?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(D,{className:"h-8 w-8 animate-spin"}),e.jsx("span",{className:"ml-2",children:"Loading receipts..."})]}):e.jsxs(S,{children:[e.jsx(C,{children:e.jsxs(l,{children:[e.jsx(t,{children:"Receipt #"}),e.jsx(t,{children:"Payment Date"}),e.jsx(t,{children:"Amount"}),e.jsx(t,{children:"Method"}),e.jsx(t,{children:"Actions"})]})}),e.jsx(T,{children:Array.isArray(A)?A.map(s=>e.jsxs(l,{children:[e.jsx(a,{className:"font-mono text-sm",children:s.receiptNumber}),e.jsx(a,{children:new Date(s.paymentDate).toLocaleDateString()}),e.jsxs(a,{className:"font-mono",children:["KSh ",parseFloat(s.amount).toLocaleString()]}),e.jsx(a,{children:s.paymentMethod}),e.jsx(a,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{variant:"outline",size:"sm",children:[e.jsx(q,{className:"h-3 w-3 mr-1"}),"View"]}),e.jsxs(r,{variant:"outline",size:"sm",children:[e.jsx(V,{className:"h-3 w-3 mr-1"}),"Download"]})]})})]},s.id)):e.jsx(l,{children:e.jsx(a,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No receipts found"})})})]})})]})})]}),e.jsx(K,{open:G,onOpenChange:L,children:e.jsxs(E,{className:"max-w-2xl",children:[e.jsx(F,{children:e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-5 w-5"}),"Maintenance Request Details"]})}),d&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{className:"text-sm font-medium",children:"Title"}),e.jsx("p",{className:"text-sm",children:d.title})]}),e.jsxs("div",{children:[e.jsx(c,{className:"text-sm font-medium",children:"Status"}),e.jsxs("div",{className:"flex items-center gap-2",children:[P(d.status),I(d.status)]})]})]}),e.jsxs("div",{children:[e.jsx(c,{className:"text-sm font-medium",children:"Description"}),e.jsx("p",{className:"text-sm",children:d.description})]}),e.jsxs("div",{children:[e.jsx(c,{className:"text-sm font-medium",children:"Date Reported"}),e.jsx("p",{className:"text-sm",children:new Date(d.createdAt).toLocaleDateString()})]})]})]})}),e.jsx(K,{open:U,onOpenChange:b,children:e.jsxs(E,{className:"max-w-md",children:[e.jsxs(F,{children:[e.jsx(B,{children:"New Maintenance Request"}),e.jsx(ne,{children:"Report a maintenance issue in your unit"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"request-title",children:"Issue Title"}),e.jsx(ie,{id:"request-title",placeholder:"e.g., Water Leak in Kitchen"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"request-description",children:"Description"}),e.jsx(le,{id:"request-description",placeholder:"Please describe the issue in detail...",rows:4})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(c,{htmlFor:"request-priority",children:"Priority"}),e.jsxs(re,{children:[e.jsx(ce,{id:"request-priority",children:e.jsx(de,{placeholder:"Select priority"})}),e.jsxs(xe,{children:[e.jsx(g,{value:"urgent",children:"Urgent (Emergency)"}),e.jsx(g,{value:"high",children:"High (Needs attention soon)"}),e.jsx(g,{value:"medium",children:"Medium (Can wait a few days)"}),e.jsx(g,{value:"low",children:"Low (Minor issue)"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(r,{variant:"outline",onClick:()=>b(!1),children:"Cancel"}),e.jsx(r,{children:"Submit Request"})]})]})]})})]})}export{we as TenantPortal};
