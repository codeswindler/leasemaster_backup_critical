import{av as K,d as j,a0 as F,j as e,C as c,G as r,x as A,a1 as D,a6 as G,a2 as P,z as o,A as x,E as V,ai as $,as as H,at as O,aA as T,aK as Q,aq as J,y as l}from"./index-D3-Phv8z.js";import{r as W}from"./vendor-BBpupLJz.js";function Z(){const[L,_]=K("/message-details/:id"),t=_?.id,{data:s,isLoading:B}=j({queryKey:["/api/message-recipients",t],enabled:!!t}),h=s?.bulk_message_id??s?.bulkMessageId,{data:a,isLoading:R}=j({queryKey:["/api/bulk-messages",h],enabled:!!h}),p=s?.tenant_id??s?.tenantId,{data:u,isLoading:I}=j({queryKey:["/api/tenants",p],enabled:!!p}),E=B||R||I,g=s?.recipient_contact??s?.recipientContact,N=s?.recipient_name??s?.recipientName,n=s?.channel??"sms",f=s?.status??"pending",v=s?.created_at??s?.createdAt,d=s?.sent_at??s?.sentAt,m=s?.delivered_at??s?.deliveredAt,y=s?.delivery_status??s?.deliveryStatus,b=s?.delivery_timestamp??s?.deliveryTimestamp,w=s?.sender_shortcode??s?.senderShortcode,C=s?.sent_by_name??s?.sentByName,S=s?.subject??a?.subject,U=s?.content??a?.content,k=s?.error_message??s?.errorMessage,M=m&&d?`${Math.round((new Date(m).getTime()-new Date(d).getTime())/1e3)} seconds`:null;W.useEffect(()=>{!t||!s||F("POST","/api/activity-logs",{action:"Message Viewed",details:`Viewed message ${t}`,type:"messaging",status:"success"})},[t,s]);const q=i=>{switch(i){case"delivered":return e.jsx(J,{className:"h-4 w-4 text-green-500"});case"pending":return e.jsx(T,{className:"h-4 w-4 text-blue-500"});case"failed":return e.jsx(Q,{className:"h-4 w-4 text-red-500"});default:return e.jsx(T,{className:"h-4 w-4 text-gray-500"})}},z=i=>{switch(i){case"delivered":return e.jsx(l,{variant:"default",className:"bg-green-100 text-green-800",children:"Delivered"});case"pending":return e.jsx(l,{variant:"secondary",children:"Pending"});case"sent":return e.jsx(l,{variant:"default",className:"bg-blue-100 text-blue-800",children:"Sent"});case"failed":return e.jsx(l,{variant:"destructive",children:"Failed"});default:return e.jsx(l,{variant:"outline",children:"Unknown"})}};return L?E?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4"}),e.jsx("div",{className:"h-32 bg-gray-200 rounded"}),e.jsx("div",{className:"h-20 bg-gray-200 rounded"})]})}):s?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(A,{variant:"outline",size:"sm",onClick:()=>window.history.back(),"data-testid":"button-back",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[n==="email"?e.jsx(G,{className:"h-6 w-6"}):e.jsx(P,{className:"h-6 w-6"}),"Message Details"]}),e.jsxs("p",{className:"text-muted-foreground",children:[n.toUpperCase()," message sent to ",u?.fullName||N||"Unknown"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(c,{className:"lg:col-span-2",children:[e.jsxs(o,{children:[e.jsx(x,{children:"Message Content"}),e.jsx(V,{children:n==="email"?"Email content and details":"SMS message content"})]}),e.jsxs(r,{className:"space-y-4",children:[n==="email"&&S&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Subject"}),e.jsx("p",{className:"text-lg font-medium",children:S})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Message"}),e.jsx("div",{className:"mt-2 p-4 bg-muted rounded-lg",children:e.jsx("p",{className:"whitespace-pre-wrap",children:U||"N/A"})})]}),k&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-red-600",children:"Error Message"}),e.jsx("div",{className:"mt-2 p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-red-700",children:k})})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(c,{children:[e.jsx(o,{children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx($,{className:"h-4 w-4"}),"Recipient"]})}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(H,{children:e.jsx(O,{children:u?.fullName?.split(" ").map(i=>i[0]).join("")||"U"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:u?.fullName||N||"Unknown"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:g||"N/A"})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Channel:"}),e.jsx("span",{className:"font-medium capitalize",children:n})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Contact:"}),e.jsx("span",{className:"font-mono",children:g||"N/A"})]}),w&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Sender:"}),e.jsx("span",{className:"font-mono",children:w})]}),C&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Sent By:"}),e.jsx("span",{children:C})]})]})]})]}),e.jsxs(c,{children:[e.jsx(o,{children:e.jsx(x,{children:"Delivery Status"})}),e.jsxs(r,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[q(f),z(f)]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Created:"}),e.jsx("span",{children:v?new Date(v).toLocaleString():"N/A"})]}),d&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Sent:"}),e.jsx("span",{children:new Date(d).toLocaleString()})]}),m&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Delivered:"}),e.jsx("span",{children:new Date(m).toLocaleString()})]}),M&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"TAT:"}),e.jsx("span",{className:"font-mono",children:M})]}),y&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"DLR:"}),e.jsx("span",{className:"font-mono",children:y})]}),b&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"DLR Time:"}),e.jsx("span",{children:new Date(b).toLocaleString()})]})]})]})]}),e.jsxs(c,{children:[e.jsx(o,{children:e.jsx(x,{children:"Message Info"})}),e.jsxs(r,{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Message ID:"}),e.jsx("span",{className:"font-mono",children:s?.id?.substring?.(0,8)||"N/A"})]}),a?.id&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Bulk Message ID:"}),e.jsx("span",{className:"font-mono",children:a.id.substring(0,8)})]}),a?.totalRecipients&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Recipients:"}),e.jsx("span",{children:a.totalRecipients})]}),a?.messageType&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Message Type:"}),e.jsx("span",{className:"capitalize",children:a.messageType})]})]})]})]})]})]}):e.jsx("div",{className:"p-6",children:e.jsx(c,{children:e.jsxs(r,{className:"p-8 text-center",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Message Not Found"}),e.jsx("p",{className:"text-muted-foreground",children:"The message details you're looking for could not be found."}),e.jsxs(A,{variant:"outline",className:"mt-4",onClick:()=>window.history.back(),children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Go Back"]})]})})}):e.jsx("div",{children:"Route not found"})}export{Z as MessageDetails};
