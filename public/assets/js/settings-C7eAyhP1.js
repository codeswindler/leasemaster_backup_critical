import{b as de,a as oe,d as A,f as Y,j as e,C as T,z as M,A as P,E as I,a2 as me,y as Z,aq as he,T as pe,G as $,K as n,I as r,x as E,a6 as ue,aw as _e,J as ee,a3 as xe,aR as je,H as ye,a0 as q,q as ge,S as ve,r as fe,s as be,v as Se,w as V}from"./index-D3-Phv8z.js";import{r as l}from"./vendor-BBpupLJz.js";import{S as L}from"./switch-n8er_Na6.js";import{T as Ne,a as ke,b as F,c as U}from"./tabs-CPhPIXkL.js";import{S as D}from"./save-lrq3yfwj.js";const se=[{key:"landlord_receipt",label:"Receipt alerts",recipient_type:"landlord",alert_type:"receipt",enable_sms:!0,enable_email:!0,frequency:"immediate"},{key:"landlord_invoice_summary",label:"Invoice alerts (count/amount)",recipient_type:"landlord",alert_type:"invoice_summary",enable_sms:!1,enable_email:!0,frequency:"daily",schedule_json:JSON.stringify({invoice_count:0,invoice_amount:0})},{key:"landlord_reminder_sent",label:"Reminder sent alerts",recipient_type:"landlord",alert_type:"reminder_sent",enable_sms:!0,enable_email:!0,frequency:"immediate"},{key:"landlord_balance_sms",label:"SMS balance notifications",recipient_type:"landlord",alert_type:"balance_sms",enable_sms:!0,enable_email:!1,frequency:"immediate",threshold_value:0},{key:"landlord_balance_email",label:"Email balance notifications",recipient_type:"landlord",alert_type:"balance_email",enable_sms:!1,enable_email:!0,frequency:"immediate",threshold_value:0},{key:"system_receipt",label:"Receipt alerts",recipient_type:"system_user",alert_type:"receipt",enable_sms:!1,enable_email:!0,frequency:"immediate"},{key:"system_invoice_summary",label:"Invoice alerts (count/amount)",recipient_type:"system_user",alert_type:"invoice_summary",enable_sms:!1,enable_email:!0,frequency:"daily",schedule_json:JSON.stringify({invoice_count:0,invoice_amount:0})},{key:"system_reminder_sent",label:"Reminder sent alerts",recipient_type:"system_user",alert_type:"reminder_sent",enable_sms:!1,enable_email:!0,frequency:"immediate"},{key:"system_balance_sms",label:"SMS balance notifications",recipient_type:"system_user",alert_type:"balance_sms",enable_sms:!0,enable_email:!1,frequency:"immediate",threshold_value:0},{key:"system_balance_email",label:"Email balance notifications",recipient_type:"system_user",alert_type:"balance_email",enable_sms:!1,enable_email:!0,frequency:"immediate",threshold_value:0},{key:"tenant_invoice_reminder",label:"Invoice reminder alerts",recipient_type:"tenant",alert_type:"tenant_invoice_reminder",enable_sms:!0,enable_email:!1,frequency:"custom",schedule_json:JSON.stringify({before_days:[3,1],after_days:[3],on_due_date:!0,reminder_every_days:3})},{key:"tenant_receipt",label:"Receipt alerts",recipient_type:"tenant",alert_type:"tenant_receipt",enable_sms:!0,enable_email:!1,frequency:"immediate"},{key:"tenant_payment_confirmation",label:"Payment confirmation messages",recipient_type:"tenant",alert_type:"payment_confirmation",enable_sms:!0,enable_email:!1,frequency:"immediate"}],Ce=c=>{if(!c)return{};try{return JSON.parse(c)}catch{return{}}};function Pe(){const{selectedPropertyId:c,selectedLandlordId:S}=de(),{toast:g}=oe(),[J,ae]=l.useState({}),ne=!c||c==="all",v=l.useMemo(()=>{const s=new URLSearchParams;return c&&s.append("propertyId",c),S&&s.append("landlordId",S),s.toString()?`?${s}`:""},[c,S]),{data:_}=A({queryKey:["/api/settings/sms",c,S],queryFn:async()=>await(await q("GET",`/api/settings/sms${v}`)).json()}),{data:d}=A({queryKey:["/api/settings/email",c,S],queryFn:async()=>await(await q("GET",`/api/settings/email${v}`)).json()}),{data:o}=A({queryKey:["/api/settings/mpesa",c,S],queryFn:async()=>await(await q("GET",`/api/settings/mpesa${v}`)).json()}),{data:f}=A({queryKey:["/api/settings/invoice",c,S],queryFn:async()=>await(await q("GET",`/api/settings/invoice${v}`)).json()}),{data:B}=A({queryKey:["/api/settings/alerts",c,S],queryFn:async()=>await(await q("GET",`/api/settings/alerts${v}`)).json()}),[b,N]=l.useState({api_url:"",api_key:"",partner_id:"",shortcode:"",sender_id:"",balance_threshold:"",enabled:!1}),[x,j]=l.useState({smtp_host:"",smtp_port:"",smtp_user:"",smtp_pass:"",smtp_secure:"tls",from_email:"",from_name:"",credit_balance:"",credit_threshold:"",enabled:!1}),[m,h]=l.useState({consumer_key:"",consumer_secret:"",passkey:"",shortcode:"",account_reference:"",stk_callback_url:"",balance_callback_url:"",initiator_name:"",security_credential:"",enabled:!1}),[y,k]=l.useState({company_name:"",company_phone:"",company_email:"",company_address:"",payment_options:"",logo_url:""}),[K,z]=l.useState(se),[Q,te]=l.useState(""),[W,O]=l.useState(!1);l.useEffect(()=>{_&&typeof _=="object"&&N({api_url:_.api_url??"",api_key:_.api_key??"",partner_id:_.partner_id??"",shortcode:_.shortcode??"",sender_id:_.sender_id??"",balance_threshold:_.balance_threshold??"",enabled:!!_.enabled})},[_]),l.useEffect(()=>{d&&typeof d=="object"&&j({smtp_host:d.smtp_host??"",smtp_port:d.smtp_port??"",smtp_user:d.smtp_user??"",smtp_pass:d.smtp_pass??"",smtp_secure:d.smtp_secure??"tls",from_email:d.from_email??"",from_name:d.from_name??"",credit_balance:d.credit_balance??"",credit_threshold:d.credit_threshold??"",enabled:!!d.enabled})},[d]),l.useEffect(()=>{o&&typeof o=="object"&&h({consumer_key:o.consumer_key??"",consumer_secret:o.consumer_secret??"",passkey:o.passkey??"",shortcode:o.shortcode??"",account_reference:o.account_reference??"",stk_callback_url:o.stk_callback_url??"",balance_callback_url:o.balance_callback_url??"",initiator_name:o.initiator_name??"",security_credential:o.security_credential??"",enabled:!!o.enabled})},[o]),l.useEffect(()=>{f&&typeof f=="object"&&k({company_name:f.company_name??"",company_phone:f.company_phone??"",company_email:f.company_email??"",company_address:f.company_address??"",payment_options:f.payment_options??"",logo_url:f.logo_url??""})},[f]);const re=s=>{ae(a=>({...a,[s]:!a[s]}))},w=(s,a,t,i)=>e.jsxs("div",{className:"relative",children:[e.jsx(r,{type:J[s]?"text":"password",value:a,placeholder:i,onChange:p=>t(p.target.value),className:"pr-10"}),e.jsx("button",{type:"button",onClick:()=>re(s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground","aria-label":J[s]?"Hide value":"Show value",children:J[s]?e.jsx(je,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})]});l.useEffect(()=>{if(Array.isArray(B)&&B.length>0){const s=new Map(B.map(a=>[`${a.recipient_type}:${a.alert_type}`,a]));z(se.map(a=>{const t=s.get(`${a.recipient_type}:${a.alert_type}`);return t?{...a,enable_sms:!!t.enable_sms,enable_email:!!t.enable_email,frequency:t.frequency??a.frequency,threshold_value:t.threshold_value??a.threshold_value,schedule_json:t.schedule_json??a.schedule_json}:a}))}},[B]);const ie=Y({mutationFn:async({section:s,payload:a})=>await(await q("PUT",`/api/settings/${s}${v}`,a)).json(),onSuccess:()=>{ge.invalidateQueries({queryKey:["/api/settings"]}),g({title:"Settings saved"})},onError:s=>{g({title:"Save failed",description:s.message||"Unable to save settings",variant:"destructive"})}}),X=Y({mutationFn:async()=>await(await q("GET",`/api/mpesa/balance${v}`)).json(),onSuccess:s=>{te(s?.balance?`KES ${s.balance}`:s?.message||"Balance fetched"),g({title:"M-Pesa balance",description:s?.balance?`Balance: KES ${s.balance}`:s?.message||"Balance fetched"})},onError:s=>{g({title:"Balance check failed",description:s?.message||"Unable to fetch balance",variant:"destructive"})}}),R=(s,a)=>{ie.mutate({section:s,payload:a})},le=async s=>{if(!s)return;if(s.size>5*1024*1024){g({title:"Logo too large",description:"Maximum logo size is 5MB.",variant:"destructive"});return}const a=new FormData;a.append("logo",s),O(!0);try{const t=await fetch(`/api/settings/invoice-logo${v}`,{method:"POST",body:a,credentials:"include"}),i=await t.json();if(!t.ok)throw new Error(i?.error||"Logo upload failed");k(p=>({...p,logo_url:i.logo_url||""})),g({title:"Logo uploaded"})}catch(t){g({title:"Logo upload failed",description:t?.message||"Unable to upload logo.",variant:"destructive"})}finally{O(!1)}},ce=async()=>{if(y.logo_url){O(!0);try{const s=await fetch(`/api/settings/invoice-logo${v}`,{method:"DELETE",credentials:"include"}),a=await s.json();if(!s.ok)throw new Error(a?.error||"Logo removal failed");k(t=>({...t,logo_url:""})),g({title:"Logo removed"})}catch(s){g({title:"Logo removal failed",description:s?.message||"Unable to remove logo.",variant:"destructive"})}finally{O(!1)}}},C=(s,a)=>{z(t=>t.map(i=>i.key===s?a(i):i))},G=s=>{const a=Ce(s.schedule_json);return e.jsxs("div",{className:"flex flex-col gap-3 border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:s.label}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.recipient_type.replace("_"," ")," â€¢ ",s.alert_type.replace(/_/g," ")]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{checked:s.enable_sms,onCheckedChange:t=>C(s.key,i=>({...i,enable_sms:t}))}),e.jsx("span",{className:"text-xs",children:"SMS"}),e.jsx(L,{checked:s.enable_email,onCheckedChange:t=>C(s.key,i=>({...i,enable_email:t}))}),e.jsx("span",{className:"text-xs",children:"Email"})]})]}),s.alert_type==="invoice_summary"&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"Summary includes invoice count, total amount, and sender details. Alerts send immediately when invoices are sent."}),s.alert_type==="balance_sms"||s.alert_type==="balance_email"?e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Threshold"}),e.jsx(r,{value:s.threshold_value??"",onChange:t=>C(s.key,i=>({...i,threshold_value:Number(t.target.value||0)}))})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Frequency"}),e.jsxs(ve,{value:s.frequency,onValueChange:t=>C(s.key,i=>({...i,frequency:t})),children:[e.jsx(fe,{children:e.jsx(be,{placeholder:"Frequency"})}),e.jsxs(Se,{children:[e.jsx(V,{value:"immediate",children:"Immediate"}),e.jsx(V,{value:"daily",children:"Daily"}),e.jsx(V,{value:"weekly",children:"Weekly"})]})]})]})]}):null,s.alert_type==="tenant_invoice_reminder"&&e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Days before due (comma separated)"}),e.jsx(r,{value:(a.before_days||[]).join(","),onChange:t=>{const i=t.target.value.split(",").map(u=>Number(u.trim())).filter(u=>!Number.isNaN(u)),p={...a,before_days:i};C(s.key,u=>({...u,schedule_json:JSON.stringify(p)}))}})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Days after due (comma separated)"}),e.jsx(r,{value:(a.after_days||[]).join(","),onChange:t=>{const i=t.target.value.split(",").map(u=>Number(u.trim())).filter(u=>!Number.isNaN(u)),p={...a,after_days:i};C(s.key,u=>({...u,schedule_json:JSON.stringify(p)}))}})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(L,{checked:!!a.on_due_date,onCheckedChange:t=>{const i={...a,on_due_date:t};C(s.key,p=>({...p,schedule_json:JSON.stringify(i)}))}}),e.jsx("span",{className:"text-sm",children:"Send on due date"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Repeat every (days)"}),e.jsx(r,{value:a.reminder_every_days??"",onChange:t=>{const i={...a,reminder_every_days:Number(t.target.value||0)};C(s.key,p=>({...p,schedule_json:JSON.stringify(i)}))}})]})]}),s.alert_type==="reminder_sent"&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"Summary includes reminder count, total amount, and sender details. Alerts send immediately when reminders are sent."})]},s.key)},H={landlord:K.filter(s=>s.recipient_type==="landlord"),system_user:K.filter(s=>s.recipient_type==="system_user"),tenant:K.filter(s=>s.recipient_type==="tenant")};return ne?e.jsx("div",{className:"p-6",children:e.jsx(T,{children:e.jsxs(M,{children:[e.jsx(P,{children:"Settings"}),e.jsx(I,{children:"Select a client and property to manage settings."})]})})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold","data-testid":"settings-title",children:"Settings"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure SMS, email, M-Pesa, invoices, and alerts"})]}),e.jsxs(Ne,{defaultValue:"sms",className:"space-y-6",children:[e.jsxs(ke,{className:"grid w-full grid-cols-5",children:[e.jsx(F,{value:"sms",children:"SMS"}),e.jsx(F,{value:"email",children:"Email"}),e.jsx(F,{value:"mpesa",children:"M-Pesa"}),e.jsx(F,{value:"invoice",children:"Invoice"}),e.jsx(F,{value:"alerts",children:"Alerts"})]}),e.jsx(U,{value:"sms",children:e.jsxs(T,{children:[e.jsx(M,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-5 w-5"}),e.jsxs("div",{children:[e.jsx(P,{children:"SMS Integration"}),e.jsx(I,{children:"Configure SMS provider credentials"})]}),e.jsx("div",{className:"ml-auto",children:b.enabled?e.jsxs(Z,{variant:"default",className:"bg-green-100 text-green-800",children:[e.jsx(he,{className:"h-3 w-3 mr-1"}),"Active"]}):e.jsxs(Z,{variant:"destructive",children:[e.jsx(pe,{className:"h-3 w-3 mr-1"}),"Inactive"]})})]})}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"API URL"}),e.jsx(r,{value:b.api_url,onChange:s=>N(a=>({...a,api_url:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(n,{children:"API Key"}),w("sms_api_key",b.api_key,s=>N(a=>({...a,api_key:s})))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Partner ID"}),w("sms_partner_id",b.partner_id,s=>N(a=>({...a,partner_id:s})))]}),e.jsxs("div",{children:[e.jsx(n,{children:"Shortcode"}),e.jsx(r,{value:b.shortcode,onChange:s=>N(a=>({...a,shortcode:s.target.value}))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Sender ID"}),e.jsx(r,{value:b.sender_id,onChange:s=>N(a=>({...a,sender_id:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Balance threshold"}),e.jsx(r,{value:b.balance_threshold,onChange:s=>N(a=>({...a,balance_threshold:s.target.value}))})]})]}),e.jsxs("div",{className:"flex items-center justify-between border rounded-lg p-3",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Enable SMS"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Use this provider for alerts"})]}),e.jsx(L,{checked:b.enabled,onCheckedChange:s=>N(a=>({...a,enabled:s}))})]}),e.jsxs(E,{onClick:()=>R("sms",b),children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Save SMS Settings"]})]})]})}),e.jsx(U,{value:"email",children:e.jsxs(T,{children:[e.jsx(M,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-5 w-5"}),e.jsxs("div",{children:[e.jsx(P,{children:"Email Integration"}),e.jsx(I,{children:"Configure SMTP settings and credit balance"})]})]})}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"SMTP Host"}),e.jsx(r,{value:x.smtp_host,onChange:s=>j(a=>({...a,smtp_host:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(n,{children:"SMTP Port"}),e.jsx(r,{value:x.smtp_port,onChange:s=>j(a=>({...a,smtp_port:s.target.value}))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"SMTP User"}),e.jsx(r,{value:x.smtp_user,onChange:s=>j(a=>({...a,smtp_user:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(n,{children:"SMTP Password"}),w("smtp_pass",x.smtp_pass,s=>j(a=>({...a,smtp_pass:s})))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"From Email"}),e.jsx(r,{value:x.from_email,onChange:s=>j(a=>({...a,from_email:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(n,{children:"From Name"}),e.jsx(r,{value:x.from_name,onChange:s=>j(a=>({...a,from_name:s.target.value}))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Email credit balance"}),e.jsx(r,{value:x.credit_balance,onChange:s=>j(a=>({...a,credit_balance:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Balance threshold"}),e.jsx(r,{value:x.credit_threshold,onChange:s=>j(a=>({...a,credit_threshold:s.target.value}))})]})]}),e.jsxs("div",{className:"flex items-center justify-between border rounded-lg p-3",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Enable Email"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Use SMTP for alerts"})]}),e.jsx(L,{checked:x.enabled,onCheckedChange:s=>j(a=>({...a,enabled:s}))})]}),e.jsxs(E,{onClick:()=>R("email",x),children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Save Email Settings"]})]})]})}),e.jsx(U,{value:"mpesa",children:e.jsxs(T,{children:[e.jsx(M,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"h-5 w-5"}),e.jsxs("div",{children:[e.jsx(P,{children:"M-Pesa STK Push"}),e.jsx(I,{children:"Configure paybill credentials"})]})]})}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Consumer Key"}),w("mpesa_consumer_key",m.consumer_key,s=>h(a=>({...a,consumer_key:s})))]}),e.jsxs("div",{children:[e.jsx(n,{children:"Consumer Secret"}),w("mpesa_consumer_secret",m.consumer_secret,s=>h(a=>({...a,consumer_secret:s})))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Passkey"}),w("mpesa_passkey",m.passkey,s=>h(a=>({...a,passkey:s})))]}),e.jsxs("div",{children:[e.jsx(n,{children:"Shortcode"}),e.jsx(r,{value:m.shortcode,onChange:s=>h(a=>({...a,shortcode:s.target.value}))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Account Reference"}),e.jsx(r,{value:m.account_reference,onChange:s=>h(a=>({...a,account_reference:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(n,{children:"STK Callback URL"}),e.jsx(r,{value:m.stk_callback_url,onChange:s=>h(a=>({...a,stk_callback_url:s.target.value}))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Balance Callback URL"}),e.jsx(r,{value:m.balance_callback_url,onChange:s=>h(a=>({...a,balance_callback_url:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Initiator Name"}),e.jsx(r,{value:m.initiator_name,onChange:s=>h(a=>({...a,initiator_name:s.target.value}))})]})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Security Credential"}),w("mpesa_security_credential",m.security_credential,s=>h(a=>({...a,security_credential:s})))]}),e.jsxs("div",{className:"flex items-center justify-between border rounded-lg p-3",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Enable M-Pesa"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Enable STK push"})]}),e.jsx(L,{checked:m.enabled,onCheckedChange:s=>h(a=>({...a,enabled:s}))})]}),e.jsxs(E,{onClick:()=>R("mpesa",m),children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Save M-Pesa Settings"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(E,{variant:"outline",onClick:()=>X.mutate(),disabled:X.isPending,children:"Check Paybill Balance"}),Q&&e.jsx("span",{className:"text-sm text-muted-foreground",children:Q})]})]})]})}),e.jsx(U,{value:"invoice",children:e.jsxs(T,{children:[e.jsx(M,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5"}),e.jsxs("div",{children:[e.jsx(P,{children:"Invoice Settings"}),e.jsx(I,{children:"Company details and payment options"})]})]})}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Company Name"}),e.jsx(r,{value:y.company_name,onChange:s=>k(a=>({...a,company_name:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Company Phone"}),e.jsx(r,{value:y.company_phone,onChange:s=>k(a=>({...a,company_phone:s.target.value}))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Company Email"}),e.jsx(r,{value:y.company_email,onChange:s=>k(a=>({...a,company_email:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Company Address"}),e.jsx(r,{value:y.company_address,onChange:s=>k(a=>({...a,company_address:s.target.value}))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-start",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Invoice Logo (max 5MB)"}),e.jsx(r,{type:"file",accept:"image/png,image/jpeg",onChange:s=>le(s.target.files?.[0]),disabled:W}),y.logo_url&&e.jsx(E,{type:"button",variant:"outline",className:"mt-2",onClick:ce,disabled:W,children:"Remove Logo"})]}),e.jsxs("div",{className:"rounded-lg border p-3",children:[e.jsx(n,{className:"text-sm text-muted-foreground",children:"Preview"}),y.logo_url?e.jsx("img",{src:y.logo_url,alt:"Invoice logo",className:"mt-2 h-16 w-auto object-contain"}):e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"No logo uploaded."})]})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Payment Options (one per line)"}),e.jsx(xe,{rows:4,value:y.payment_options,onChange:s=>k(a=>({...a,payment_options:s.target.value}))})]}),e.jsxs(E,{onClick:()=>R("invoice",y),children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Save Invoice Settings"]})]})]})}),e.jsx(U,{value:"alerts",children:e.jsxs(T,{children:[e.jsx(M,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ee,{className:"h-5 w-5"}),e.jsxs("div",{children:[e.jsx(P,{children:"Alert Settings"}),e.jsx(I,{children:"Landlord, system user, and tenant rules"})]})]})}),e.jsxs($,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{className:"text-sm font-medium",children:"Landlord Alerts"}),H.landlord.map(G)]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{className:"text-sm font-medium",children:"System User Alerts"}),H.system_user.map(G)]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{className:"text-sm font-medium",children:"Tenant Alerts"}),H.tenant.map(G)]}),e.jsxs(E,{onClick:()=>R("alerts",{alerts:K.map(s=>({...s,channel:"multi",frequency:["invoice_summary","reminder_sent","receipt","payment_confirmation","tenant_receipt"].includes(s.alert_type)?"immediate":s.frequency,enabled:s.enable_sms||s.enable_email}))}),children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Save Alert Settings"]})]})]})})]})]})}export{Pe as Settings};
