import{c as M,d as H,j as e,D as R,a3 as $,x as c,P as B,g as I,h as V,i as K,k as W,K as n,I as x,S as p,r as f,s as v,v as A,w as i,av as N,C as b,z as w,A as S,E as y,aP as G,H as O,G as C,ac as J,ad as q,ae as T,af as o,ag as Q,ah as m,y as r,am as Y,aQ as _}from"./index-BtknkMaH.js";import{r as g}from"./vendor-Dl_IvdXv.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=M("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=M("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);function ae(){const[E,u]=g.useState(!1),[h,k]=g.useState(!1),[t,d]=g.useState({name:"",email:"",role:"",password:"",permissions:[],region:"Africa/Nairobi",timezone:"Africa/Nairobi"}),{data:D=[]}=H({queryKey:["/api/users"]}),z=D.map(s=>({id:s.id,name:s.username,email:`${s.username}@rentflow.com`,role:"Administrator",status:"active",lastLogin:new Date().toLocaleString(),permissions:["properties","tenants","accounting","reports","users","settings"]})),j=[{id:"properties",name:"Properties Management",description:"Create, edit, and manage properties"},{id:"tenants",name:"Tenant Management",description:"Manage tenant information and leases"},{id:"accounting",name:"Accounting",description:"Invoicing, payments, and financial records"},{id:"reports",name:"Reports",description:"Generate and view reports"},{id:"messaging",name:"Messaging",description:"Send SMS and email notifications"},{id:"users",name:"User Management",description:"Manage system users and permissions"},{id:"settings",name:"System Settings",description:"Configure system and API settings"}],P=()=>{console.log("Adding new user:",t),alert("User added successfully!"),d({name:"",email:"",role:"",password:"",permissions:[],region:"Africa/Nairobi",timezone:"Africa/Nairobi"}),u(!1)},U=s=>{d(a=>({...a,permissions:a.permissions.includes(s)?a.permissions.filter(l=>l!==s):[...a.permissions,s]}))},L=s=>{switch(s){case"Administrator":return e.jsx(r,{variant:"default",className:"bg-red-100 text-red-800",children:"Administrator"});case"Manager":return e.jsx(r,{variant:"default",className:"bg-blue-100 text-blue-800",children:"Manager"});case"Accountant":return e.jsx(r,{variant:"default",className:"bg-green-100 text-green-800",children:"Accountant"});case"Support":return e.jsx(r,{variant:"outline",children:"Support"});default:return e.jsx(r,{variant:"outline",children:s})}},F=s=>{switch(s){case"active":return e.jsx(r,{variant:"default",className:"bg-green-100 text-green-800",children:"Active"});case"inactive":return e.jsx(r,{variant:"destructive",children:"Inactive"});default:return e.jsx(r,{variant:"outline",children:s})}};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold","data-testid":"user-management-title",children:"User Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage system users and their permissions"})]}),e.jsxs(R,{open:E,onOpenChange:u,children:[e.jsx($,{asChild:!0,children:e.jsxs(c,{"data-testid":"button-add-user",children:[e.jsx(B,{className:"h-4 w-4 mr-2"}),"Add User"]})}),e.jsxs(I,{className:"sm:max-w-[600px]",children:[e.jsxs(V,{children:[e.jsx(K,{children:"Add New User"}),e.jsx(W,{children:"Create a new system user and assign permissions"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"name",children:"Full Name"}),e.jsx(x,{id:"name",placeholder:"John Doe",value:t.name,onChange:s=>d(a=>({...a,name:s.target.value})),"data-testid":"input-user-name"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"email",children:"Email Address"}),e.jsx(x,{id:"email",type:"email",placeholder:"john@example.com",value:t.email,onChange:s=>d(a=>({...a,email:s.target.value})),"data-testid":"input-user-email"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"role",children:"Role"}),e.jsxs(p,{value:t.role,onValueChange:s=>d(a=>({...a,role:s})),children:[e.jsx(f,{"data-testid":"select-user-role",children:e.jsx(v,{placeholder:"Select role"})}),e.jsxs(A,{children:[e.jsx(i,{value:"Administrator",children:"Administrator"}),e.jsx(i,{value:"Manager",children:"Manager"}),e.jsx(i,{value:"Accountant",children:"Accountant"}),e.jsx(i,{value:"Support",children:"Support"})]})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"password",children:"Password"}),e.jsx(x,{id:"password",type:"password",placeholder:"Enter password",value:t.password,onChange:s=>d(a=>({...a,password:s.target.value})),"data-testid":"input-user-password"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"region",children:"Region / Timezone"}),e.jsxs(p,{value:t.region,onValueChange:s=>{const a={"East Africa":"Africa/Nairobi","West Africa":"Africa/Lagos","Southern Africa":"Africa/Johannesburg","North Africa":"Africa/Cairo","Central Africa":"Africa/Kinshasa",Europe:"Europe/London",Asia:"Asia/Dubai",Americas:"America/New_York"};d(l=>({...l,region:s,timezone:a[s]||"Africa/Nairobi"}))},children:[e.jsx(f,{"data-testid":"select-user-region",children:e.jsx(v,{placeholder:"Select region"})}),e.jsxs(A,{children:[e.jsx(i,{value:"East Africa",children:"East Africa (Africa/Nairobi - EAT)"}),e.jsx(i,{value:"West Africa",children:"West Africa (Africa/Lagos - WAT)"}),e.jsx(i,{value:"Southern Africa",children:"Southern Africa (Africa/Johannesburg - SAST)"}),e.jsx(i,{value:"North Africa",children:"North Africa (Africa/Cairo - EET)"}),e.jsx(i,{value:"Central Africa",children:"Central Africa (Africa/Kinshasa - WAT)"}),e.jsx(i,{value:"Europe",children:"Europe (Europe/London - GMT/BST)"}),e.jsx(i,{value:"Asia",children:"Asia (Asia/Dubai - GST)"}),e.jsx(i,{value:"Americas",children:"Americas (America/New_York - EST/EDT)"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Determines timezone for records and reports. Default: Nairobi, Kenya (EAT)"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"timezone-display",children:"Selected Timezone"}),e.jsx(x,{id:"timezone-display",value:t.timezone,disabled:!0,className:"bg-muted"})]})]}),e.jsxs("div",{children:[e.jsx(n,{className:"text-base font-medium mb-3 block",children:"Permissions"}),e.jsx("div",{className:"space-y-3 max-h-48 overflow-y-auto border rounded-lg p-3",children:j.map(s=>e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(N,{id:s.id,checked:t.permissions.includes(s.id),onCheckedChange:()=>U(s.id),"data-testid":`checkbox-permission-${s.id}`}),e.jsxs("div",{className:"grid gap-1.5 leading-none",children:[e.jsx(n,{htmlFor:s.id,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description})]})]},s.id))})]})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(c,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),e.jsx(c,{onClick:P,"data-testid":"button-submit-user",children:"Add User"})]})]})]})]}),e.jsxs(b,{children:[e.jsx(w,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(S,{children:"System Users"}),e.jsx(y,{children:"Manage user accounts and permissions"})]}),e.jsxs(c,{variant:"outline",size:"sm",onClick:()=>k(!h),"data-testid":"button-toggle-passwords",children:[h?e.jsx(G,{className:"h-4 w-4 mr-2"}):e.jsx(O,{className:"h-4 w-4 mr-2"}),h?"Hide":"Show"," Passwords"]})]})}),e.jsx(C,{children:e.jsxs(J,{children:[e.jsx(q,{children:e.jsxs(T,{children:[e.jsx(o,{children:"User"}),e.jsx(o,{children:"Role"}),e.jsx(o,{children:"Status"}),e.jsx(o,{children:"Last Login"}),e.jsx(o,{children:"Permissions"}),e.jsx(o,{children:"Actions"})]})}),e.jsx(Q,{children:z.map(s=>e.jsxs(T,{className:"hover-elevate",children:[e.jsx(m,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.email}),h&&e.jsx("p",{className:"text-xs font-mono text-muted-foreground",children:"Password: ********"})]})}),e.jsx(m,{children:L(s.role)}),e.jsx(m,{children:F(s.status)}),e.jsx(m,{className:"text-sm",children:s.lastLogin}),e.jsx(m,{children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.permissions.slice(0,3).map(a=>e.jsx(r,{variant:"outline",className:"text-xs",children:j.find(l=>l.id===a)?.name||a},a)),s.permissions.length>3&&e.jsxs(r,{variant:"outline",className:"text-xs",children:["+",s.permissions.length-3," more"]})]})}),e.jsx(m,{children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(c,{variant:"ghost",size:"sm","data-testid":`button-edit-user-${s.id}`,children:e.jsx(Y,{className:"h-4 w-4"})}),e.jsx(c,{variant:"ghost",size:"sm","data-testid":`button-permissions-${s.id}`,children:e.jsx(_,{className:"h-4 w-4"})}),s.role!=="Administrator"&&e.jsx(c,{variant:"ghost",size:"sm","data-testid":`button-delete-user-${s.id}`,children:e.jsx(Z,{className:"h-4 w-4"})})]})})]},s.id))})]})})]}),e.jsxs(b,{children:[e.jsxs(w,{children:[e.jsx(S,{children:"Permission Management"}),e.jsx(y,{children:"Define what each role can access"})]}),e.jsx(C,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:["Administrator","Manager","Accountant","Support"].map(s=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(X,{className:"h-5 w-5 text-primary"}),e.jsx("h4",{className:"font-medium",children:s})]}),e.jsx("div",{className:"space-y-2",children:j.map(a=>{const l=s==="Administrator"||s==="Manager"&&!["users","settings"].includes(a.id)||s==="Accountant"&&["accounting","reports"].includes(a.id)||s==="Support"&&["tenants","reports"].includes(a.id);return e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N,{checked:l,disabled:!0,"data-testid":`permission-${s}-${a.id}`}),e.jsx(n,{className:"text-sm",children:a.name})]},a.id)})})]},s))})})]})]})}export{ae as UserManagement};
