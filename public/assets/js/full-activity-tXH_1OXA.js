import{b as W,d as z,j as e,x as Q,C as w,z as N,A as S,E as C,G as b,K as d,I as g,S as T,r as A,s as L,v as U,w as t,ac as $,ad as J,ae as p,af as n,ag as X,ah as a,b0 as Y,U as F,T as v,a7 as Z,B as ee,aA as se,aO as te,aC as D,au as ae,y as i,a0 as re}from"./index-BtknkMaH.js";import{r as o}from"./vendor-Dl_IvdXv.js";import{D as ne}from"./download-ILkuwfnn.js";function de(){const{selectedPropertyId:u}=W(),[r,E]=o.useState(""),[l,B]=o.useState("all"),[j,I]=o.useState("all"),[x,_]=o.useState("2024-12-01"),[h,q]=o.useState("2024-12-31"),{data:m=[],isLoading:P}=z({queryKey:["/api/activity-logs",r,l,u,x,h],queryFn:async()=>{const s=new URLSearchParams;r&&s.append("search",r),l!=="all"&&s.append("type",l),u&&s.append("propertyId",u),x&&s.append("dateFrom",x),h&&s.append("dateTo",h);const c=`/api/activity-logs?${s.toString()}`;return await(await re("GET",c)).json()}}),R=Array.from(new Set(m.map(s=>s.user_name).filter(Boolean))),y=m.filter(s=>{const c=s.action?.toLowerCase().includes(r.toLowerCase())||s.details?.toLowerCase().includes(r.toLowerCase())||s.user_name?.toLowerCase().includes(r.toLowerCase()),f=l==="all"||s.type===l,O=j==="all"||s.user_name===j;return c&&f&&O}),k=s=>{switch(s){case"payment":return e.jsx(te,{className:"h-4 w-4"});case"invoice":return e.jsx(se,{className:"h-4 w-4"});case"tenant":return e.jsx(F,{className:"h-4 w-4"});case"property":return e.jsx(ee,{className:"h-4 w-4"});case"notification":case"messaging":return e.jsx(Z,{className:"h-4 w-4"});case"maintenance":return e.jsx(v,{className:"h-4 w-4"});case"user":return e.jsx(F,{className:"h-4 w-4"});default:return e.jsx(Y,{className:"h-4 w-4"})}},H=s=>{switch(s){case"success":return e.jsx(ae,{className:"h-4 w-4 text-green-500"});case"pending":return e.jsx(D,{className:"h-4 w-4 text-blue-500"});case"warning":return e.jsx(v,{className:"h-4 w-4 text-yellow-500"});case"error":return e.jsx(v,{className:"h-4 w-4 text-red-500"});default:return e.jsx(D,{className:"h-4 w-4 text-gray-500"})}},M=s=>{switch(s){case"success":return e.jsx(i,{variant:"default",className:"bg-green-100 text-green-800",children:"Success"});case"pending":return e.jsx(i,{variant:"outline",children:"Pending"});case"warning":return e.jsx(i,{variant:"secondary",children:"Warning"});case"error":return e.jsx(i,{variant:"destructive",children:"Error"});default:return e.jsx(i,{variant:"outline",children:s})}},V=s=>{const c={payment:"bg-green-100 text-green-800",invoice:"bg-blue-100 text-blue-800",tenant:"bg-purple-100 text-purple-800",property:"bg-orange-100 text-orange-800",notification:"bg-yellow-100 text-yellow-800",messaging:"bg-indigo-100 text-indigo-800",maintenance:"bg-red-100 text-red-800",user:"bg-gray-100 text-gray-800"};return e.jsx(i,{variant:"default",className:c[s]||"bg-gray-100 text-gray-800",children:s.charAt(0).toUpperCase()+s.slice(1)})},G=()=>{console.log("Exporting activity data"),alert("Activity log exported successfully!")},K=R;return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold","data-testid":"full-activity-title",children:"User Activity Log"}),e.jsx("p",{className:"text-muted-foreground",children:"Complete system activity and user actions"})]}),e.jsxs(Q,{onClick:G,"data-testid":"button-export-activity",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Export Activity Log"]})]}),e.jsxs(w,{children:[e.jsxs(N,{children:[e.jsx(S,{children:"Filter Activity"}),e.jsx(C,{children:"Search and filter system activities"})]}),e.jsx(b,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"search",children:"Search"}),e.jsx(g,{id:"search",placeholder:"Search activities...",value:r,onChange:s=>E(s.target.value),"data-testid":"input-search-activity"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"filter-type",children:"Activity Type"}),e.jsxs(T,{value:l,onValueChange:B,children:[e.jsx(A,{"data-testid":"select-filter-type",children:e.jsx(L,{})}),e.jsxs(U,{children:[e.jsx(t,{value:"all",children:"All Types"}),e.jsx(t,{value:"payment",children:"Payments"}),e.jsx(t,{value:"invoice",children:"Invoices"}),e.jsx(t,{value:"tenant",children:"Tenants"}),e.jsx(t,{value:"property",children:"Properties"}),e.jsx(t,{value:"notification",children:"Notifications"}),e.jsx(t,{value:"messaging",children:"Messaging"}),e.jsx(t,{value:"maintenance",children:"Maintenance"}),e.jsx(t,{value:"user",children:"User Actions"})]})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"filter-user",children:"User"}),e.jsxs(T,{value:j,onValueChange:I,children:[e.jsx(A,{"data-testid":"select-filter-user",children:e.jsx(L,{})}),e.jsxs(U,{children:[e.jsx(t,{value:"all",children:"All Users"}),K.map(s=>e.jsx(t,{value:s,children:s},s))]})]})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"start-date",children:"Start Date"}),e.jsx(g,{id:"start-date",type:"date",value:x,onChange:s=>_(s.target.value),"data-testid":"input-start-date"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"end-date",children:"End Date"}),e.jsx(g,{id:"end-date",type:"date",value:h,onChange:s=>q(s.target.value),"data-testid":"input-end-date"})]})]})})]}),e.jsxs(w,{children:[e.jsxs(N,{children:[e.jsx(S,{children:"Activity Log"}),e.jsxs(C,{children:["Showing ",y.length," of ",m.length," activities"]})]}),e.jsx(b,{children:e.jsxs($,{children:[e.jsx(J,{children:e.jsxs(p,{children:[e.jsx(n,{children:"Activity"}),e.jsx(n,{children:"Type"}),e.jsx(n,{children:"Details"}),e.jsx(n,{children:"User"}),e.jsx(n,{children:"Timestamp"}),e.jsx(n,{children:"Amount"}),e.jsx(n,{children:"Status"})]})}),e.jsx(X,{children:P?e.jsx(p,{children:e.jsx(a,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"Loading activity logs..."})}):y.map(s=>e.jsxs(p,{className:"hover-elevate",children:[e.jsx(a,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[k(s.type),e.jsx("span",{className:"font-medium",children:s.action})]})}),e.jsx(a,{children:V(s.type)}),e.jsx(a,{className:"max-w-md",children:e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:s.details})}),e.jsx(a,{children:s.user_name||"System"}),e.jsx(a,{className:"font-mono text-sm",children:s.created_at?new Date(s.created_at).toLocaleString():"N/A"}),e.jsx(a,{children:s.amount&&e.jsx("span",{className:"font-mono text-sm",children:s.amount})}),e.jsx(a,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[H(s.status),M(s.status)]})})]},s.id))})]})})]})]})}export{de as FullActivity};
